from django.db import models


default_instructions = """–ö—Ä–∞–π–Ω–∏–π –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∫–æ–¥: <code>{code}</code> –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç-–∫–æ–¥–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–ª–∏–∫ –≤ —É–¥–æ–±–Ω–æ–º –¥–ª—è –í–∞—Å —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ –ø–æ —Å—Å—ã–ª–∫–µ: üëâüèº https://gambrinus.ru/pivnierestorani üëâüèº https://blackangus.rest/bron –ò–ª–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É : ¬´–ì–∞–º–±—Ä–∏–Ω—É—Å¬ª +7(499)380-87-77 ¬´Black Angus¬ª +7(499)113-00-01 üìå –°–∫–∏–¥–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—Ç–æ–ª–∞ —Å –ø–æ–º–µ—Ç–∫–æ–π –æ –Ω–∞–ª–∏—á–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç-–∫–æ–¥–∞. üìå–ü–µ—Ä–µ–¥ –∑–∞–∫–∞–∑–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–¥—ä—è–≤–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç-–∫–æ–¥ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞. –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –¥–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç-–∫–æ–¥–∞ –¥–æ 31.10.2023 –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –º–µ–Ω—é –º–æ–∂–Ω–æ –ø–æ —Å—Å—ã–ª–∫–µ: üëâüèº https://gambrinus.ru/kitchen üëâüèº https://blackangus.rest/kitchen –¢–∞–∫–∂–µ ,–æ—Ç –Ω–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –ö–æ–∑—ã—Ä–Ω–∞—è –ö–∞—Ä—Ç–∞, –º—ã –¥–∞—Ä–∏–º –ø–æ–¥–∞—Ä–æ–∫ –ø–æ –∫–æ–¥–æ–≤–æ–º—É —Å–ª–æ–≤—É: ‚ñ´Ô∏è MOSGA –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–∞—Ä–∫–∞ –≤ ¬´–ì–∞–º–±—Ä–∏–Ω—É—Å¬ª ‚ñ´Ô∏è MOSBA –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–∞—Ä–∫–∞ –≤ ¬´Black Angus¬ª üí∞ –°–∫–∞—á–∞—Ç—å –ö–æ–∑—ã—Ä–Ω—É—é –∫–∞—Ä—Ç—É –º–æ–∂–Ω–æ –ø–æ —Å—Å—ã–ª–∫–µ http://www.trump.ru/ *–∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–≤–µ—Å—Ç–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –≤ —Ä–∞–∑–¥–µ–ª–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã. –î–æ –≤—Å—Ç—Ä–µ—á–∏ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞—Ö —Å–µ—Ç–∏ ‚Äú–ì–∞–º–±—Ä–∏–Ω—É—Å‚Äù –∏ —Å—Ç–µ–π–∫-—Ö–∞—É—Å–µ ‚ÄúBlack Angus‚Äù!"""
default_conditions = """–ö—Ä–∞–π–Ω–∏–π –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∫–æ–¥: <code>{code}</code> –£—Å–ª–æ–≤–∏—è: üî∏ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –±—ã—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º –Ω–∞ –∫–∞–Ω–∞–ª—ã –ì–∞–º–±—Ä–∏–Ω—É—Å –∏ –ë–ª—ç–∫ –ê–Ω–≥—É—Å üî∏–£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç-–∫–æ–¥ –¥–∞–µ—Ç –ø—Ä–∞–≤–æ –Ω–∞ —Å–∫–∏–¥–∫—É 50% –æ—Ç —Å—á–µ—Ç–∞, –Ω–æ –Ω–µ –±–æ–ª–µ–µ 3000 —Ä—É–±–ª–µ–π. üî∏ –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –≤—Å–µ –º–µ–Ω—é –≤ —Å–µ—Ç–∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ ‚Äú–ì–∞–º–±—Ä–∏–Ω—É—Å‚Äù –∏ —Å—Ç–µ–π–∫-—Ö–∞—É—Å–∞ ‚ÄúBlack Angus‚Äù üî∏ –°–∫–∏–¥–∫–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—Ç–æ–ª–∞ —Å –ø–æ–º–µ—Ç–∫–æ–π –Ω–∞–ª–∏—á–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç-–∫–æ–¥–∞ üî∏ –ù–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –¥–µ–ª–æ–≤—ã–µ –æ–±–µ–¥—ã, —É—Å–ª—É–≥—É ‚Äú—Å —Å–æ–±–æ–π‚Äù üî∏ –ù–µ —Å—É–º–º–∏—Ä—É–µ—Ç—Å—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–∫–∏–¥–∫–∞–º–∏, –∞–∫—Ü–∏—è–º–∏ –∏ —Å–ø–µ—Ü–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏. üî∏ –ù–µ –¥–µ–π—Å—Ç–≤—É–µ—Ç –ø–æ –ø—è—Ç–Ω–∏—Ü–∞–º –î–∞–Ω–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç-–∫–æ–¥–æ–º –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–æ 31.10.2023 –î–æ –≤—Å—Ç—Ä–µ—á–∏ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞—Ö —Å–µ—Ç–∏ ‚Äú–ì–∞–º–±—Ä–∏–Ω—É—Å‚Äù –∏ —Å—Ç–µ–π–∫-—Ö–∞—É—Å–µ ‚ÄúBlack Angus‚Äù!"""


class Code(models.Model):
    id = models.AutoField(primary_key=True, verbose_name="ID")
    phrase = models.CharField(max_length=255, verbose_name="–ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ")
    is_active = models.BooleanField(default=True, verbose_name="–ê–∫—Ç–∏–≤–µ–Ω?")
    max_uses = models.IntegerField(default=0, verbose_name="–õ–∏–º–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π (0 - –±–µ–∑ –ª–∏–º–∏—Ç–∞)")  # 0 means unlimited
    uses = models.IntegerField(default=0, verbose_name="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ —Ä–∞–∑")
    instructions = models.TextField(max_length=10000, verbose_name="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏", default=default_instructions)
    conditions = models.TextField(max_length=10000, verbose_name="–£—Å–ª–æ–≤–∏—è", default=default_conditions)

    def __str__(self):
        return self.phrase

    class Meta:
        verbose_name = "–ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ"
        verbose_name_plural = "–ö–æ–¥–æ–≤—ã–µ —Å–ª–æ–≤–∞"

    @property
    def is_valid(self):
        return self.is_active and (self.max_uses == 0 or self.uses < self.max_uses)


class UniqueCode(models.Model):
    id = models.AutoField(primary_key=True, verbose_name="ID")
    code = models.CharField(max_length=255, unique=True, verbose_name="–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥")
    phrase_code = models.ForeignKey(Code, on_delete=models.CASCADE, verbose_name="–ö–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ")
    used = models.BooleanField(default=False, verbose_name="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω?")

    class Meta:
        verbose_name = "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥"
        verbose_name_plural = "–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–¥—ã"
